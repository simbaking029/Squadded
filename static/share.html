<!DOCTYPE html>

<body></body>
<script>
    const monoMerchants = ['https://development.store.jennyfer.demandware.net', 'https://sam-advisor.com/myboutique'];
    const urlParams = new URLSearchParams(window.location.search);

    const saveRedirect = (params) => {
        const squad = urlParams.get('squad');
        localStorage.setItem('squad', squad || '');
    };

    let siteUrl;
    if (monoMerchants.includes(urlParams.get('site'))) {
        saveRedirect();
        window.location.href = urlParams.get('site');
    } else if (navigator.userAgent.match(/Android/i)) {
        siteUrl = 'https://play.google.com/store/apps/details?id=com.squadded.squaddedapp&ah=3xTyfeuluPsvpRL00pqPY8__EfI';
    } else if (
        navigator.userAgent.match(/iPhone/i) ||
        navigator.userAgent.match(/iPad/i) ||
        navigator.userAgent.match(/iPod/i)
    ) {
        siteUrl = 'https://www.squadded.co/login';
        window.location.href = siteUrl;
    } else if (!chrome || !chrome.runtime) {
        saveRedirect();
        siteUrl = 'https://www.squadded.co/login';
        window.location.href = siteUrl;
    } else {
        const EXTENSION_ID = 'nkgjblonklmhncmdijkecjoniegjhifd';
        chrome.runtime.sendMessage(EXTENSION_ID, 'ping', (response) => {
            console.log(response)
            saveRedirect();
            if (response !== 'pong') {
                siteUrl = 'https://www.squadded.co/login';
            } else {
                siteUrl = urlParams.get('site');
            }
            window.location.href = siteUrl;
        });
    }
</script>
